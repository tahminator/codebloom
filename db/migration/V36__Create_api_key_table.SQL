CREATE TABLE IF NOT EXISTS "ApiKeyEnum" (
    id SMALLINT PRIMARY KEY,
    code TEXT NOT NULL UNIQUE,
    description TEXT
);

CREATE TABLE IF NOT EXISTS "ApiKey" (
    id VARCHAR(64) PRIMARY KEY,
    "apiKey" TEXT NOT NULL,
    "access" SMALLINT NOT NULL,
    "expiresAt" TIMESTAMP WITH TIME ZONE NOT NULL,
    "createdAt" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    "updatedAt" TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),
    "updatedBy" UUID,
    CONSTRAINT "fk_apiKey_access" FOREIGN KEY ("access") REFERENCES "ApiKeyEnum" (id) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT "fk_apiKey_user" FOREIGN KEY ("updatedBy") REFERENCES "User" (id) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT "uq_apiKey_hash" UNIQUE ("apiKey")
);